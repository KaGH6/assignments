# 課題：インターネットTV
好きな時間に好きな場所で話題の動画を無料で楽しめる「インターネットTVサービス」のデータベース設計をしました。

# ステップ1
設計したテーブルは以下の通りです。
<br>

- テーブル：genres

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| genre_id    |  INTEGER |         | PRIMARY   |       |  YES   |
| genre_name   |   varchar(20) |       | UNIQUE   |     |     |
<br>

- テーブル：channels

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| channel_id   |  INTEGER |         | PRIMARY   |       |  YES   |
| channel_name   |   varchar(20) |       | UNIQUE   |     |     |
<br>

- テーブル：program_schedules

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| schedule_id   |  INTEGER |         | PRIMARY  |       |  YES   |
| channel_id  | INTEGER |         |  FOREIGN   |       |  YES   |
| episode_id  |INTEGER |    |   FOREIGN  |   |    |
| episode_time  |INTEGER |         |     |       |    |
| release_date  |DATETIME |         |     |       |    |
<br>

- テーブル：programs

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| program_id   |  INTEGER |         | PRIMARY   |       |  YES   |
| program_name   |   varchar(20) |       |      |     |     |
| genre_id   |  INTEGER |         | FOREIGN   |       |  YES   |
| channel_id   |  INTEGER |       | FOREIGN   |     |  YES    |
<br>

- テーブル：series

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| program_id   |  INTEGER |         | FOREIGN   |       |  YES   |
| series_id   | INTEGER |       |   PRIMARY   |     |  YES    |
| series_name  |  varchar(20) |         |     |       |     |
| program_id   |  INTEGER |         | FOREIGN   |       |  YES   |
<br>

- テーブル：seasons

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| series_id   |  INTEGER |         | FOREIGN   |       |  YES   |
| season_id   | INTEGER |       |   PRIMARY   |     |  YES    |
| season_number  |  INTEGER |         |     |       |    |
| program_id   |  INTEGER |         | FOREIGN   |       |  YES   |
<br>

- テーブル：episodes

| カラム名|データ型 |NULL| キー|初期値 |AUTO INCREMENT|
|:----------|-----------:|:-----------|:----------|-----------:|:-----------|
| season_id   |  INTEGER |         | FOREIGN   |       |  YES   |
| episode_id   | INTEGER |       |   PRIMARY   |     |  YES    |
| episode_name  |varchar(20) |         |     |       |    |
| episode_description  |varchar(40) |  YES  |     |  '見てください' |    |
| view_number  |INTEGER |         |     |       |    |
| program_id   |  INTEGER |         | FOREIGN   |       |  YES   |
<br>


# ステップ2
実際にテーブルを構築し、データを入れる手順について解説します。
<br>

1. データベース名：apprentice3
2. 構築したテーブル：TV_tables.sql に記載
3. サンプルデータ：sampledata.sql に記載

### 1. データベースを構築
任意のディレクトリに「apprentice3」をフォルダごと置いてください。apprentice3フォルダをデータベースとして使用していきます。

### 2. テーブルを構築
TV_tables.sqlを確認し、各ブロックごとに上から順に挿入してください。

### 3. サンプルデータを挿入
sampledata.sqlを確認し、各ブロックごとに上から順に挿入してください。
<br>

# ステップ3
データを抽出するクエリは以下の通りです。

#### 1. よく見られているエピソード
 エピソード視聴数トップ3のエピソードタイトルと視聴数を取得
 
```sql
SELECT episode_name AS エピソードタイトル, view_number AS 視聴数 FROM episodes ORDER BY view_number DESC LIMIT 3;
```

<details><summary>出力結果</summary>

```
+--------------------------+---------+  
| エピソードタイトル       | 視聴数  |  
+--------------------------+---------+  
| 第3話 伝説の冒険         | 1000000 |  
| 第2話 戦況の変化         | 1000000 |  
| 第2話 無限列車の戦士たち |  950000 |  
+--------------------------+---------+  
```
</details>

#### 2. よく見られているエピソードの番組情報やシーズン情報
エピソード視聴数トップ3の番組タイトル、シーズン数、エピソード数、エピソードタイトル、視聴数を取得

```sql
SELECT
programs.program_name AS '番組タイトル',
COUNT(seasons.season_id) AS 'シーズン数',
COUNT(episodes.episode_id) AS 'エピソード数',
episodes.episode_name AS 'エピソードタイトル',
episodes.view_number AS '視聴数'
FROM programs
INNER JOIN seasons ON programs.program_id = seasons.program_id
INNER JOIN episodes ON seasons.season_id = episodes.season_id
GROUP BY programs.program_name, episodes.episode_name, episodes.view_number
ORDER BY episodes.view_number DESC LIMIT 3;
```

<details><summary>出力結果</summary>

```
+--------------+------------+--------------+--------------------------+---------+  
| 番組タイトル | シーズン数 | エピソード数 | エピソードタイトル       | 視聴数  |  
+--------------+------------+--------------+--------------------------+---------+  
| ワンピース   |          1 |            1 | 第3話 伝説の冒険         | 1000000 |  
| 進撃の巨人   |          1 |            1 | 第2話 戦況の変化         | 1000000 |  
| 鬼滅の刃     |          1 |            1 | 第2話 無限列車の戦士たち |  950000 |  
+--------------+------------+--------------+--------------------------+---------+  
```
</details>

#### 3. 本日の番組表
本日放送される全ての番組の、チャンネル名、放送開始時刻(日付+時間)、放送終了時刻、シーズン数、エピソード数、エピソードタイトル、エピソード詳細を取得

```sql
SELECT
channels.channel_name AS 'チャンネル名',
program_schedules.release_date AS '放送開始時刻',
program_schedules.release_date + INTERVAL episodes.episode_time MINUTE AS '放送終了時刻',
COUNT(seasons.season_id) AS 'シーズン数',
COUNT(episodes.episode_id) AS 'エピソード数',
episodes.episode_name AS 'エピソードタイトル',
episodes.episode_description AS 'エピソード詳細'
FROM program_schedules
INNER JOIN episodes ON program_schedules.episode_id = episodes.episode_id
INNER JOIN channels ON channels.channel_id = program_schedules.channel_id
INNER JOIN seasons ON episodes.season_id = seasons.season_id
GROUP BY channels.channel_name, program_schedules.release_date, episodes.episode_time, episodes.episode_name, episodes.episode_description;
```

<details><summary>出力結果</summary>

```
+--------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+  
| チャンネル名 | 放送開始時刻        | 放送終了時刻        | シーズン数 | エピソード数 | エピソードタイトル           | エピソード詳細                                                     |  
+--------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+  
| NHK          | 2025-02-05 05:00:00 | 2025-02-05 05:30:00 |          1 |            1 | 第3話 戦いの始まり           | エレンは巨人との戦いに突入し、その力を試される。                   |  
| NHK          | 2025-02-05 05:30:00 | 2025-02-05 06:00:00 |          1 |            1 | 第4話 進撃の決戦             | エレンたちは巨人との激しい戦闘を繰り広げる。                       |  
| NHK          | 2025-02-05 06:00:00 | 2025-02-05 06:30:00 |          1 |            1 | 第5話 逆襲の時               | エレンは巨人に立ち向かう時が来たと感じ、戦いの決意を固める。       |  
| NHK          | 2025-02-05 06:30:00 | 2025-02-05 07:00:00 |          1 |            1 | 第1話 新たな戦士             | 新たな戦士が登場し、戦局に変化が訪れる。                           |  
| NHK          | 2025-02-05 14:00:00 | 2025-02-05 14:30:00 |          1 |            1 | 第3話 東の海の冒険           | ルフィたちは東の海で新たな冒険を始める。                           |  
| NHK          | 2025-02-05 14:30:00 | 2025-02-05 15:00:00 |          1 |            1 | 第1話 アラバスタの王国       | ルフィたちはアラバスタ王国に到着し、新たな敵と戦う。               |  
| TBS          | 2025-02-05 02:30:00 | 2025-02-05 03:00:00 |          1 |            1 | 第2話 無限列車の戦士たち     | 炭治郎たちは再び無限列車での戦いに挑む。                           |  
| TBS          | 2025-02-05 03:00:00 | 2025-02-05 03:30:00 |          1 |            1 | 第3話 竈門炭治郎の決意       | 炭治郎は仲間を守るため、さらなる力を得ようと決意する。             |  
| TBS          | 2025-02-05 03:30:00 | 2025-02-05 04:00:00 |          1 |            1 | 第4話 新たな仲間             | 炭治郎は新たな仲間と共に鬼殺隊を支えるため戦う。                   |  
| TBS          | 2025-02-05 04:00:00 | 2025-02-05 04:30:00 |          1 |            1 | 第1話 壁外調査               | エレンと仲間たちは壁外調査に出発し、巨人との戦いが始まる。         |  
| TBS          | 2025-02-05 04:30:00 | 2025-02-05 05:00:00 |          1 |            1 | 第2話 巨人の出現             | 壁外調査中に巨人の出現を確認し、危機が迫る。                       |  
| TBS          | 2025-02-05 12:30:00 | 2025-02-05 13:00:00 |          1 |            1 | 第4話 ザ・デッドリーフィア   | 悟空はその戦いで重要な選択を迫られる。                             |  
| TBS          | 2025-02-05 13:00:00 | 2025-02-05 13:30:00 |          1 |            1 | 第1話 ゴールドロジャーの伝説 | ルフィはゴールドロジャーの伝説を聞き、海賊王を目指す。             |  
| TBS          | 2025-02-05 13:30:00 | 2025-02-05 14:00:00 |          1 |            1 | 第2話 新たな仲間             | ルフィは仲間を集め、冒険の旅に出る。                               |  
| テレビ朝日   | 2025-02-05 00:00:00 | 2025-02-05 00:30:00 |          1 |            1 | 第1話 鬼殺隊入隊             | 炭治郎は鬼の村で家族を失い、鬼殺隊に入隊する決意を固める。         |  
| テレビ朝日   | 2025-02-05 00:30:00 | 2025-02-05 01:00:00 |          1 |            1 | 第2話 炭治郎の誓い           | 炭治郎は家族を守るため、鬼殺隊の修行を開始する。                   |  
| テレビ朝日   | 2025-02-05 01:00:00 | 2025-02-05 01:30:00 |          1 |            1 | 第3話 鬼殺隊の仲間たち       | 炭治郎は鬼殺隊の仲間たちと出会い、共に戦いながら成長していく。     |  
| テレビ朝日   | 2025-02-05 01:30:00 | 2025-02-05 02:00:00 |          1 |            1 | 第4話 無限列車               | 炭治郎と仲間たちは、無限列車に乗り込み、鬼の連鎖を止めるため戦う。 |  
| テレビ朝日   | 2025-02-05 02:00:00 | 2025-02-05 02:30:00 |          1 |            1 | 第1話 鬼の力を知る           | 炭治郎は新たな鬼との戦いでその恐ろしさを実感する。                 |  
| テレビ朝日   | 2025-02-05 11:00:00 | 2025-02-05 11:30:00 |          1 |            1 | 第1話 宇宙の覇者             | 悟空は新たな宇宙の戦士と対決し、地球を守るため戦う。               |  
| テレビ朝日   | 2025-02-05 11:30:00 | 2025-02-05 12:00:00 |          1 |            1 | 第2話 新たな力               | 悟空は新たな力を得るため、修行に励む。                             |  
| テレビ朝日   | 2025-02-05 12:00:00 | 2025-02-05 12:30:00 |          1 |            1 | 第3話 最強の戦士             | 最強の戦士が登場し、悟空との戦闘が激化する。                       |  
| フジテレビ   | 2025-02-05 07:00:00 | 2025-02-05 07:30:00 |          1 |            1 | 第2話 戦況の変化             | 戦況が激化し、エレンたちは決死の覚悟で戦い続ける。                 |  
| フジテレビ   | 2025-02-05 07:30:00 | 2025-02-05 08:00:00 |          1 |            1 | 第3話 救世主編               | 新たな希望がエレンたちに現れ、巨人との戦いの突破口を開く。         |  
| フジテレビ   | 2025-02-05 08:00:00 | 2025-02-05 08:30:00 |          1 |            1 | 第4話 巨人の秘密             | 巨人の謎が明らかになり、戦いの真実が迫る。                         |  
| フジテレビ   | 2025-02-05 08:30:00 | 2025-02-05 09:00:00 |          1 |            1 | 第5話 希望の光               | エレンたちは希望を見いだし、最後の戦いに挑む。                     |  
| フジテレビ   | 2025-02-05 15:00:00 | 2025-02-05 15:30:00 |          1 |            1 | 第2話 新しい敵               | ルフィたちは新しい敵に直面し、戦闘を繰り広げる。                   |  
| フジテレビ   | 2025-02-05 15:30:00 | 2025-02-05 16:00:00 |          1 |            1 | 第3話 伝説の冒険             | ルフィは伝説的な冒険の始まりを迎える。                             |  
| 日本テレビ   | 2025-02-05 09:00:00 | 2025-02-05 09:30:00 |          1 |            1 | 第1話 ナメック星の決戦       | 悟空はナメック星で激しい戦闘を繰り広げ、仲間たちと戦う。           |  
| 日本テレビ   | 2025-02-05 09:30:00 | 2025-02-05 10:00:00 |          1 |            1 | 第2話 フリーザの復活         | フリーザが復活し、悟空たちは再び危機に直面する。                   |  
| 日本テレビ   | 2025-02-05 10:00:00 | 2025-02-05 10:30:00 |          1 |            1 | 第3話 セルの恐怖             | セルが新たな強敵として現れ、悟空たちに試練をもたらす。             |  
| 日本テレビ   | 2025-02-05 10:30:00 | 2025-02-05 11:00:00 |          1 |            1 | 第4話 魔人ブウの陰謀         | 魔人ブウの陰謀が発覚し、悟空たちはその野望を阻止するために戦う。   |  
| 日本テレビ   | 2025-02-05 16:00:00 | 2025-02-05 16:30:00 |          1 |            1 | 第1話 黒の暴牛               | アスタは黒の暴牛に入団し、仲間たちと共に魔法戦に挑む。             |  
| 日本テレビ   | 2025-02-05 16:30:00 | 2025-02-05 17:00:00 |          1 |            1 | 第2話 魔法帝の挑戦           | アスタは魔法帝の挑戦を受け、魔法の力を磨く。                       |  
+--------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+  
```
</details>

#### 4. 本日から一週間分のドラマのチャンネルの番組表
ドラマのチャンネルの、放送開始時刻、放送終了時刻、シーズン数、エピソード数、エピソードタイトル、エピソード詳細を本日から一週間分を取得

```sql
SELECT
genres.genre_name AS 'ジャンル名',
program_schedules.release_date AS '放送開始時刻',
program_schedules.release_date + INTERVAL episodes.episode_time MINUTE AS '放送終了時刻',
COUNT(seasons.season_id) AS 'シーズン数',
COUNT(episodes.episode_id) AS 'エピソード数',
episodes.episode_name AS 'エピソードタイトル',
episodes.episode_description AS 'エピソード詳細'
FROM program_schedules
INNER JOIN episodes ON program_schedules.episode_id = episodes.episode_id
INNER JOIN channels ON channels.channel_id = program_schedules.channel_id
INNER JOIN seasons ON episodes.season_id = seasons.season_id
INNER JOIN programs ON program_schedules.channel_id = programs.channel_id
INNER JOIN genres ON programs.genre_id = genres.genre_id
WHERE release_date >= (NOW() - INTERVAL 7 DAY)
AND genres.genre_id = 1
GROUP BY channels.channel_name, program_schedules.release_date, episodes.episode_time, episodes.episode_name, episodes.episode_description;
```

<details><summary>出力結果</summary>

```
+------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+  
| ジャンル名 | 放送開始時刻        | 放送終了時刻        | シーズン数 | エピソード数 | エピソードタイトル           | エピソード詳細                                                     |  
+------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+  
| ドラマ     | 2025-02-05 05:00:00 | 2025-02-05 05:30:00 |          1 |            1 | 第3話 戦いの始まり           | エレンは巨人との戦いに突入し、その力を試される。                   |  
| ドラマ     | 2025-02-05 05:30:00 | 2025-02-05 06:00:00 |          1 |            1 | 第4話 進撃の決戦             | エレンたちは巨人との激しい戦闘を繰り広げる。                       |  
| ドラマ     | 2025-02-05 06:00:00 | 2025-02-05 06:30:00 |          1 |            1 | 第5話 逆襲の時               | エレンは巨人に立ち向かう時が来たと感じ、戦いの決意を固める。       |  
| ドラマ     | 2025-02-05 06:30:00 | 2025-02-05 07:00:00 |          1 |            1 | 第1話 新たな戦士             | 新たな戦士が登場し、戦局に変化が訪れる。                           |  
| ドラマ     | 2025-02-05 14:00:00 | 2025-02-05 14:30:00 |          1 |            1 | 第3話 東の海の冒険           | ルフィたちは東の海で新たな冒険を始める。                           |  
| ドラマ     | 2025-02-05 14:30:00 | 2025-02-05 15:00:00 |          1 |            1 | 第1話 アラバスタの王国       | ルフィたちはアラバスタ王国に到着し、新たな敵と戦う。               |  
| ドラマ     | 2025-02-05 02:30:00 | 2025-02-05 03:00:00 |          1 |            1 | 第2話 無限列車の戦士たち     | 炭治郎たちは再び無限列車での戦いに挑む。                           |  
| ドラマ     | 2025-02-05 03:00:00 | 2025-02-05 03:30:00 |          1 |            1 | 第3話 竈門炭治郎の決意       | 炭治郎は仲間を守るため、さらなる力を得ようと決意する。             |  
| ドラマ     | 2025-02-05 03:30:00 | 2025-02-05 04:00:00 |          1 |            1 | 第4話 新たな仲間             | 炭治郎は新たな仲間と共に鬼殺隊を支えるため戦う。                   |  
| ドラマ     | 2025-02-05 04:00:00 | 2025-02-05 04:30:00 |          1 |            1 | 第1話 壁外調査               | エレンと仲間たちは壁外調査に出発し、巨人との戦いが始まる。         |  
| ドラマ     | 2025-02-05 04:30:00 | 2025-02-05 05:00:00 |          1 |            1 | 第2話 巨人の出現             | 壁外調査中に巨人の出現を確認し、危機が迫る。                       |  
| ドラマ     | 2025-02-05 12:30:00 | 2025-02-05 13:00:00 |          1 |            1 | 第4話 ザ・デッドリーフィア   | 悟空はその戦いで重要な選択を迫られる。                             |  
| ドラマ     | 2025-02-05 13:00:00 | 2025-02-05 13:30:00 |          1 |            1 | 第1話 ゴールドロジャーの伝説 | ルフィはゴールドロジャーの伝説を聞き、海賊王を目指す。             |  
| ドラマ     | 2025-02-05 13:30:00 | 2025-02-05 14:00:00 |          1 |            1 | 第2話 新たな仲間             | ルフィは仲間を集め、冒険の旅に出る。                               |  
| ドラマ     | 2025-02-05 00:00:00 | 2025-02-05 00:30:00 |          1 |            1 | 第1話 鬼殺隊入隊             | 炭治郎は鬼の村で家族を失い、鬼殺隊に入隊する決意を固める。         |  
| ドラマ     | 2025-02-05 00:30:00 | 2025-02-05 01:00:00 |          1 |            1 | 第2話 炭治郎の誓い           | 炭治郎は家族を守るため、鬼殺隊の修行を開始する。                   |  
| ドラマ     | 2025-02-05 01:00:00 | 2025-02-05 01:30:00 |          1 |            1 | 第3話 鬼殺隊の仲間たち       | 炭治郎は鬼殺隊の仲間たちと出会い、共に戦いながら成長していく。     |  
| ドラマ     | 2025-02-05 01:30:00 | 2025-02-05 02:00:00 |          1 |            1 | 第4話 無限列車               | 炭治郎と仲間たちは、無限列車に乗り込み、鬼の連鎖を止めるため戦う。 |  
| ドラマ     | 2025-02-05 02:00:00 | 2025-02-05 02:30:00 |          1 |            1 | 第1話 鬼の力を知る           | 炭治郎は新たな鬼との戦いでその恐ろしさを実感する。                 |  
| ドラマ     | 2025-02-05 11:00:00 | 2025-02-05 11:30:00 |          1 |            1 | 第1話 宇宙の覇者             | 悟空は新たな宇宙の戦士と対決し、地球を守るため戦う。               |  
| ドラマ     | 2025-02-05 11:30:00 | 2025-02-05 12:00:00 |          1 |            1 | 第2話 新たな力               | 悟空は新たな力を得るため、修行に励む。                             |  
| ドラマ     | 2025-02-05 12:00:00 | 2025-02-05 12:30:00 |          1 |            1 | 第3話 最強の戦士             | 最強の戦士が登場し、悟空との戦闘が激化する。                       |  
| ドラマ     | 2025-02-05 07:00:00 | 2025-02-05 07:30:00 |          1 |            1 | 第2話 戦況の変化             | 戦況が激化し、エレンたちは決死の覚悟で戦い続ける。                 |  
| ドラマ     | 2025-02-05 07:30:00 | 2025-02-05 08:00:00 |          1 |            1 | 第3話 救世主編               | 新たな希望がエレンたちに現れ、巨人との戦いの突破口を開く。         |  
| ドラマ     | 2025-02-05 08:00:00 | 2025-02-05 08:30:00 |          1 |            1 | 第4話 巨人の秘密             | 巨人の謎が明らかになり、戦いの真実が迫る。                         |  
| ドラマ     | 2025-02-05 08:30:00 | 2025-02-05 09:00:00 |          1 |            1 | 第5話 希望の光               | エレンたちは希望を見いだし、最後の戦いに挑む。                     |  
| ドラマ     | 2025-02-05 15:00:00 | 2025-02-05 15:30:00 |          1 |            1 | 第2話 新しい敵               | ルフィたちは新しい敵に直面し、戦闘を繰り広げる。                   |  
| ドラマ     | 2025-02-05 15:30:00 | 2025-02-05 16:00:00 |          1 |            1 | 第3話 伝説の冒険             | ルフィは伝説的な冒険の始まりを迎える。                             |  
+------------+---------------------+---------------------+------------+--------------+------------------------------+--------------------------------------------------------------------+   
```
</details>

#### 5. 直近一週間で最も見られた番組
直近一週間に放送された番組の中で、エピソード視聴数合計トップ2の番組に対する、番組タイトル、視聴数を取得

```sql
SELECT
programs.program_name AS '番組タイトル',
SUM(episodes.view_number) AS '視聴数'
FROM episodes
INNER JOIN programs ON episodes.program_id = programs.program_id
INNER JOIN program_schedules ON episodes.episode_id = program_schedules.episode_id
WHERE program_schedules.release_date >= (NOW() - INTERVAL 7 DAY)
GROUP BY programs.program_name
ORDER BY SUM(episodes.view_number) DESC LIMIT 2;
```

<details><summary>出力結果</summary>

```
+-----------------+---------+  
| 番組タイトル    | 視聴数  |  
+-----------------+---------+  
| 進撃の巨人      | 6650000 |  
| ドラゴンボールZ | 4550000 |  
+-----------------+---------+  
```
</details>

#### 6. ジャンルごとの番組の視聴数ランキング
ジャンルごとの視聴数トップの番組の、ジャンル名、番組タイトル、エピソード平均視聴数を取得

```sql
SELECT
genre_name AS 'ジャンル名',
programs.program_name AS '番組タイトル',
AVG(episodes.view_number) AS 'エピソード平均視聴数' 
FROM genres
INNER JOIN programs ON genres.genre_id = programs.genre_id
INNER JOIN channels ON programs.channel_id = channels.channel_id
INNER JOIN series ON programs.program_id = series.program_id
INNER JOIN seasons ON series.series_id = seasons.series_id
INNER JOIN episodes ON seasons.season_id = episodes.season_id
GROUP BY genre_name, programs.program_name
ORDER BY AVG(episodes.view_number) DESC;
```

<details><summary>出力結果</summary>

```
+------------+----------------------+----------------------+  
| ジャンル名 | 番組タイトル         | エピソード平均視聴数 |  
+------------+----------------------+----------------------+  
| ドラマ     | 半沢直樹             |          850000.0000 |  
| アニメ     | ワンピース           |          733333.3333 |  
| アニメ     | 進撃の巨人           |          665000.0000 |  
| ドラマ     | コンフィデンスマンJP |          650000.0000 |  
| アニメ     | ドラゴンボールZ      |          568750.0000 |  
| アニメ     | 鬼滅の刃             |          465000.0000 |  
| ニュース   | おはよう日本         |          400000.0000 |  
| アニメ     | ブラッククローバー   |          371428.5714 |  
| ドラマ     | 大河ドラマ           |          316666.6667 |  
| ドラマ     | 相棒                 |          150000.0000 |  
+------------+----------------------+----------------------+  
```
</details>

